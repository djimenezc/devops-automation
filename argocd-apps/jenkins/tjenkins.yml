apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: tjenkins
  namespace: argocd
spec:
  destination:
    namespace: buildenv
    name: kay-test
  project: dev-aws-project
  source:
    chart: jenkins
    repoURL: https://charts.jenkins.io
    targetRevision: ^4.0.0
    helm:
      releaseName: tjenkins
      values: |
        # if jenkins fails to start, rename jcasc / configScripts to xconfigScripts
        #deploymentStrategy: {type: "Recreate"}

        rbac:
          create: true

        sidecars:
          configAutoReload:
            enabled: true

        persistence:
          enabled: true
          #existingClaim: jenkins-home

        controller:
          imagePullPolicy: Always
          image: "jenkins/jenkins"
          tag: "2.371-jdk11"

          #tagLabel:
          adminSecret: false
          #serviceType: NodePort
          #servicePort: 80
          jenkinsUrlProtocol: https
          jenkinsUrl: "https://tjenkins.buildenv.vqpn.net/"
          jenkinsAdminEmail: "kay.ramme@savigermany.de"

          executorMode: "EXCLUSIVE"

          # need to install "prometheus-operator"
          prometheus:
          #  enabled: true
            scrapeEndpoint: /prometheus

          ingress:
            enabled: true
            hostName: "tjenkins.buildenv.vqpn.net"
            #ingressClassName: systeminternalingress

            annotations:
              external-dns.alpha.kubernetes.io/alias: 'true'
              kubernetes.io/ingress.class: systeminternalingress

          resources:
            limits:
              cpu: "5"
              memory: 6Gi

            requests:
              cpu: "2"
              memory: 6Gi

          additionalPlugins:
            - code-coverage-api:3.1.0
            - matrix-project:785.v06b_7f47b_c631
            - display-url-api:2.3.6
            - jquery-detached:1.2.1
            - junit:1119.1121.vc43d0fc45561
            - popper-api:1.16.1-3
            - aws-java-sdk-sqs:1.12.287-357.vf82d85a_6eefd
            - blueocean:1.25.8
            - commons-lang3-api:3.12.0-36.vd97de6465d5b_
            - ssh-agent:295.v9ca_a_1c7cc3a_a_
            - config-autorefresh-plugin:1.0
            - simple-theme-plugin:103.va_161d09c38c7
            - aws-java-sdk-cloudformation:1.12.287-357.vf82d85a_6eefd
            - jacoco:3.3.2
            - aws-credentials:191.vcb_f183ce58b_9
            - image-gallery:2.0.2
            - jaxb:2.3.6-1
            - pipeline-stage-tags-metadata:2.2114.v2654ca_721309
            - kubernetes-client-api:5.12.2-193.v26a_6078f65a_9
            - ansicolor:1.0.2
            - blueocean-jira:1.25.8
            - aws-java-sdk:1.12.287-357.vf82d85a_6eefd
            - token-macro:308.v4f2b_ed62b_b_16
            - workflow-cps-global-lib:588.v576c103a_ff86
            - job-dsl:1.81
            - warnings-ng:9.19.2
            - aws-java-sdk-efs:1.12.287-357.vf82d85a_6eefd
            - branch-api:2.1046.v0ca_37783ecc5
            - blueocean-pipeline-editor:1.25.8
            - blueocean-i18n:1.25.8
            - blueocean-jwt:1.25.8
            - envinject-api:1.199.v3ce31253ed13
            - mapdb-api:1.0.9-28.vf251ce40855d
            - blueocean-pipeline-api-impl:1.25.8
            - sshd:3.249.v2dc2ea_416e33
            - blueocean-events:1.25.8
            - jenkins-design-language:1.25.8
            - mina-sshd-api-core:2.9.1-44.v476733c11f82
            - instant-messaging:1.50
            - solarized-theme:0.1
            - jdk-tool:55.v1b_32b_6ca_f9ca
            - pipeline-stage-view:2.24
            - handy-uri-templates-2-api:2.1.8-22.v77d5b_75e6953
            - parameterized-trigger:2.45
            - aws-java-sdk-ec2:1.12.287-357.vf82d85a_6eefd
            - github-api:1.303-400.v35c2d8258028
            - run-condition:1.5
            - commons-text-api:1.9-19.v8df45c678366
            - aws-java-sdk-elasticbeanstalk:1.12.287-357.vf82d85a_6eefd
            - blueocean-github-pipeline:1.25.8
            - basic-branch-build-strategies:1.3.2
            - github-branch-source:1695.v88de84e9f6b_9
            - build-name-setter:2.2.0
            #            - workflow-aggregator:590.v6a_d052e5a_a_b_5
            - aws-java-sdk-sns:1.12.287-357.vf82d85a_6eefd
            - aws-java-sdk-codebuild:1.12.287-357.vf82d85a_6eefd
        #            - jakarta-activation-api:2.0.1-1
        #            - forensics-api:1.16.0
        #            - mask-passwords:3.3
        #            - bootstrap4-api:4.6.0-5
        #            - blueocean-web:1.25.8
        #            - javax-mail-api:1.6.2-7
        #            - favorite:2.4.1
        #            - trilead-api:2.72.v2a_3236754f73
        #            - jnr-posix-api:3.1.15-1
        #            - authentication-tokens:1.4
        #            - slave-setup:1.10
        #            - instance-identity:116.vf8f487400980
        #            - ant:481.v7b_09e538fcca
        #            - pipeline-groovy-lib:612.v84da_9c54906d
        #            - cobertura:1.17
        #            - ace-editor:1.1
        #            - workflow-scm-step:400.v6b_89a_1317c9a_
        #            - pipeline-utility-steps:2.13.0
        #            - pam-auth:1.10
        #            - conditional-buildstep:1.4.2
        #            - aws-java-sdk-logs:1.12.287-357.vf82d85a_6eefd
        #            - htmlpublisher:1.31
        #            - pipeline-model-definition:2.2114.v2654ca_721309
        #            - matrix-auth:3.1.5
        #            - workflow-durable-task-step:1199.v02b_9244f8064
        #            - dashboard-view:2.447.vda_124dd35f11
        #            - docker-workflow:521.v1a_a_dd2073b_2e
        #            - pipeline-rest-api:2.24
        #            - role-strategy:561.v9846c7351a_41
        #            - extended-read-permission:3.2
        #            - font-awesome-api:6.2.0-1
        #            - momentjs:1.1.1
        #            - aws-secrets-manager-credentials-provider:1.189.vdb_b_86ddd16e8
        #            - blueocean-pipeline-scm-api:1.25.8
        #            - kubernetes:3706.vdfb_d599579f3
        #            - blueocean-bitbucket-pipeline:1.25.8
        #            - workflow-basic-steps:994.vd57e3ca_46d24
        #            - bouncycastle-api:2.26
        #            - node-iterator-api:49.v58a_8b_35f8363
        #            - git:4.12.1
        #            - workflow-step-api:639.v6eca_cd8c04a_a_
        #            - plugin-util-api:2.17.0
        #            - analysis-model-api:10.16.1
        #            - configuration-as-code:1512.vb_79d418d5fc8
        #            - compact-columns:1.148.v649c8db_2a_91e
        #            - resource-disposer:0.20
        #            - data-tables-api:1.12.1-3
        #            - git-server:99.va_0826a_b_cdfa_d
        #            - config-file-provider:3.11.1
        #            - checks-api:1.7.5
        #            - popper2-api:2.11.6-1
        #            - blueocean-rest:1.25.8
        #            - jersey2-api:2.37-1
        #            - pegdown-formatter:1.3
        #            - prometheus:2.0.11
        #            - jquery:1.12.4-1
        #            - downstream-build-cache:1.7
        #            - blueocean-core-js:1.25.8
        #            - workflow-job:1236.vc3a_d1602f439
        #            - workflow-support:838.va_3a_087b_4055b
        #            - structs:324.va_f5d6774f3a_d
        #            - command-launcher:90.v669d7ccb_7c31
        #            - ghprb:1.42.2
        #            - blueocean-autofavorite:1.2.5
        #            - script-security:1183.v774b_0b_0a_a_451
        #            - build-blocker-plugin:1.7.8
        #            - mailer:438.v02c7f0a_12fa_4
        #            - ssh-slaves:2.846.v1b_70190624f5
        #            - ws-cleanup:0.43
        #            - aws-java-sdk-ecr:1.12.287-357.vf82d85a_6eefd
        #            - ssh-credentials:305.v8f4381501156
        #            - jackson2-api:2.13.3-285.vc03c0256d517
        #            - timestamper:1.20
        #            - snakeyaml-api:1.31-84.ve43da_fb_49d0b
        #            - pipeline-graph-analysis:195.v5812d95a_a_2f9
        #            - windows-slaves:1.8.1
        #            - view-job-filters:2.3
        #            - workflow-api:1192.v2d0deb_19d212
        #            - blueocean-dashboard:1.25.8
        #            - scm-api:621.vda_a_b_055e58f7
        #            - display-upstream-changes:0.3.2
        #            - pipeline-github:2.8-138.d766e30bb08b
        #            - pipeline-model-api:2.2114.v2654ca_721309
        #            - preSCMbuildstep:0.3
        #            - envinject:2.875.v9b_9e962da_a_ec
        #            - JJWT Plugin (jjwt-api:0.11.5-77.v646c772fddb_0
        #            - blueocean-display-url:2.4.1
        #            - aws-java-sdk-ecs:1.12.287-357.vf82d85a_6eefd
        #            - pubsub-light:1.17
        #            - prism-api:1.28.0-2
        #            - javadoc:226.v71211feb_e7e9
        #            - ionicons-api:24.va_745a_b_a_97fc3
        #            - Office-365-Connector:4.17.0
        #            - swarm:3.36
        #            - javax-activation-api:1.2.0-4
        #            - inline-pipeline:1.0.2
        #            - okhttp-api:4.9.3-108.v0feda04578cf
        #            - credentials-binding:523.vd859a_4b_122e6
        #            - pipeline-stage-step:296.v5f6908f017a_5
        #            - blueocean-git-pipeline:1.25.8
        #            - workflow-cps:2759.v87459c4eea_ca_
        #            - project-stats-plugin:0.4
        #            - sloccount:1.26
        #            - aws-java-sdk-minimal:1.12.287-357.vf82d85a_6eefd
        #            - greenballs:1.15.1
        #            - cloudbees-bitbucket-branch-source:791.vb_eea_a_476405b
        #            - jira:3.8
        #            - atlassian-jira-software-cloud:2.0.6
        #            - bootstrap5-api:5.2.1-1
        #            - ircbot:2.44
        #            - blueocean-personalization:1.25.8
        #            - theme-manager:1.5
        #            - lockable-resources:2.16
        #            - kubernetes-credentials:0.9.0
        #            - PrioritySorter:4.1.0
        #            - blueocean-commons:1.25.8
        #            - next-build-number:1.8
        #            - dark-theme:245.vb_a_2b_b_010ea_96
        #            - credentials:1189.vf61b_a_5e2f62e
        #            - plain-credentials:139.ved2b_9cf7587b
        #            - console-column-plugin:131.vcf0ddb_8858c3
        #            - throttle-concurrents:2.9
        #            - antisamy-markup-formatter:2.7
        #            - git-client:3.12.0
        #            - performance:3.20
        #            - jquery3-api:3.6.1-1
        #            - mina-sshd-api-common:2.9.1-44.v476733c11f82
        #            - handlebars:3.0.8
        #            - pipeline-build-step:2.18
        #            - github:1.35.0
        #            - progress-bar-column-plugin:1.0
        #            - github-autostatus:3.6.2
        #            - material-theme:0.5.2-rc97.4586a_2cd1b_0b
        #            - pipeline-multibranch-defaults:2.1
        #            - metrics:4.2.10-389.v93143621b_050
        #            - cloudbees-disk-usage-simple:170.va_fd5b_4ee6858
        #            - pipeline-github-lib:38.v445716ea_edda_
        #            - jsch:0.1.55.61.va_e9ee26616e7
        #            - variant:59.vf075fe829ccb
        #            - workflow-multibranch:716.vc692a_e52371b_
        #            - monitoring:1.91.0
        #            - build-monitor-plugin:1.13+build.202205140447
        #            - apache-httpcomponents-client-4-api:4.5.13-138.v4e7d9a_7b_a_e61
        #            - caffeine-api:2.9.3-65.v6a_47d0f4d1fe
        #            - durable-task:500.v8927d9fd99d8
        #            - pipeline-milestone-step:101.vd572fef9d926
        #            - aws-java-sdk-iam:1.12.287-357.vf82d85a_6eefd
        #            - sse-gateway:1.26
        #            - blueocean-rest-impl:1.25.8
        #            - blueocean-config:1.25.8
        #            - docker-commons:1.21
        #            - ec2:2.0.2
        #            - project-description-setter:1.2
        #            - embeddable-build-status:255.va_d2370ee8fde
        #            - pipeline-model-extensions:2.2114.v2654ca_721309
        #            - echarts-api:5.3.3-1
        #            - pipeline-input-step:451.vf1a_a_4f405289
        #            - maven-plugin:3.19
        #            - built-on-column:1.1
        #            - testng-plugin:555.va0d5f66521e3
        #            - show-build-parameters:1.0
        #            - buildtriggerbadge:251.vdf6ef853f3f5
        #            - aws-java-sdk-ssm:1.12.287-357.vf82d85a_6eefd
        #            - jakarta-mail-api:2.0.1-1
        #            - build-timeout:1.24
        #            - cloudbees-folder:6.758.vfd75d09eea_a_1

          installLatestSpecifiedPlugins: true

          javaOpts: >-
             -Xmx4G
             -Xms4G
             -XX:+UseG1GC
             -XX:+UseStringDeduplication
             -XX:+UseCompressedClassPointers
             -XX:+UseCompressedOops
             -Dgroovy.use.classvalue=true
             -Dhudson.model.UsageStatistics.disabled=true

          JCasC:
            securityRealm: |-
              local:
                allowsSignup: false
                enableCaptcha: false
                users:
                - id: "test"
                  name: "Jenkins Admin"
                  password: "test"

            authorizationStrategy: |-
              loggedInUsersCanDoAnything:
                allowAnonymousRead: false

            configScripts:
              welcome-message: |
                jenkins:
                  systemMessage: Welcome to our CI\CD server.

              notifications-conf: |
                unclassified:
                  webhook:
                    globalName: "jenkins-notifications"
                    globalUrl: "https://promo4de.webhook.office.com/webhookb2"
                  warningsParsers:
                    consoleLogScanningPermitted: true

              envs-conf: |
                jenkins:
                  quietPeriod: 0
                  scmCheckoutRetryCount: 2
                  # slaveAgentPort: 4444
                  globalNodeProperties:
                  - envVars:
                      env:
                      - key: "FORCE_COLOR"
                        value: "3"
                      - key: "REPORTER"
                        value: "xunit"

              glob-creds-conf: |
                globalCredentialsConfiguration:
                  configuration:
                    providerFilter:
                      includes:
                        classNames:
                        - "com.cloudbees.hudson.plugins.folder.properties.FolderCredentialsProvider"
                        - "com.cloudbees.plugins.credentials.SystemCredentialsProvider$ProviderImpl"
                        - "com.cloudbees.plugins.credentials.UserCredentialsProvider"
                    typeFilter:
                      includes:
                        classNames:
                        - "com.cloudbees.plugins.credentials.impl.UsernamePasswordCredentialsImpl"
                        - "com.cloudbees.jenkins.plugins.awscredentials.AWSCredentialsImpl"
                        - "io.jenkins.plugins.credentials.secretsmanager.factory.ssh_user_private_key.AwsSshUserPrivateKey"
                        - "com.cloudbees.jenkins.plugins.sshcredentials.impl.BasicSSHUserPrivateKey"
                        - "org.jenkinsci.plugins.plaincredentials.impl.FileCredentialsImpl"
                        - "org.jenkinsci.plugins.plaincredentials.impl.StringCredentialsImpl"
                        - "io.jenkins.plugins.credentials.secretsmanager.factory.username_password.AwsUsernamePasswordCredentials"

              nodes-conf: |
                jenkins:
                  nodes:
                  - permanent:
                      labelString: "win32 evc buildnpm.install"
                      launcher:
                        jnlp:
                          webSocket: true
                          workDirSettings:
                            disabled: false
                            failIfWorkDirIsMissing: false
                            internalDir: "remoting"
                      mode: EXCLUSIVE
                      name: "dell-win.reg"
                      numExecutors: 4
                      remoteFS: "c:/Users/kay/jobs"
                      retentionStrategy: "always"
                  - permanent:
                      labelString: "darwin buildnpm.install"
                      launcher:
                        ssh:
                          credentialsId: "5510c120-2985-4c24-8ecd-067b95957e86"
                          host: "macvirt-1.reg"
                          jvmOptions: "-classpath /Users/jenkins/jaxb-api-2.4.0-b180830.0359.jar"
                          launchTimeoutSeconds: 240
                          maxNumRetries: 0
                          port: 22
                          prefixStartSlaveCmd: "PATH=/usr/local/opt/node@16/bin:/usr/local/bin:/Users/jenkins/.node_modules/bin:$PATH:$HOME/bin;"
                          retryWaitTime: 0
                          sshHostKeyVerificationStrategy: "nonVerifyingKeyVerificationStrategy"
                      mode: EXCLUSIVE
                      name: "macvirt-1.reg"
                      numExecutors: 4
                      remoteFS: "/Users/jenkins"
                      retentionStrategy: "always"
                  - permanent:
                      labelString: "holly ff chrome win32 edge ie11 analytics-test.install automation.install\
                        \ offermanager-test.install secureprintathome-test.install dashboard-test.install\
                        \ banner-test.install brandedlandingpage-test.install carelink-test.install\
                        \ dashboard-test.install directprint-test.install iframe-eu-test.install"
                      launcher:
                        jnlp:
                          webSocket: true
                          workDirSettings:
                            disabled: false
                            failIfWorkDirIsMissing: false
                            internalDir: "remoting"
                      mode: EXCLUSIVE
                      name: "winvirt-1.reg"
                      nodeProperties:
                      - "disableDeferredWipeout"
                      numExecutors: 4
                      remoteFS: "C:\\Users\\jenkins\\jobs"
                      retentionStrategy: "always"
                  - permanent:
                      labelString: "holly ff chrome win32 edge ie11 analytics-test.install automation.install\
                        \ offermanager-test.install secureprintathome-test.install dashboard-test.install\
                        \ banner-test.install brandedlandingpage-test.install carelink-test.install\
                        \ dashboard-test.install directprint-test.install iframe-eu-test.install"
                      launcher:
                        jnlp:
                          webSocket: true
                          workDirSettings:
                            disabled: false
                            failIfWorkDirIsMissing: false
                            internalDir: "remoting"
                      mode: EXCLUSIVE
                      name: "winvirt-2.reg"
                      nodeProperties:
                      - "disableDeferredWipeout"
                      numExecutors: 4
                      remoteFS: "c:/Users/jenkins/jobs"
                      retentionStrategy: "always"


              prim-view-conf: |
                jenkins:
                  primaryView:
                    list:
                      columns:
                      - "buildButton"
                      - "status"
                      - "weather"
                      - "progressBarColumn"
                      - lastBuildTriggerColumn:
                          causeDisplayType: "iconOnly"
                      - "jobName"
                      - "lastSuccess"
                      - "lastFailure"
                      - "lastDuration"
                      includeRegex: "(?!PROD.*).*"
                      jobFilters:
                      - statusFilter:
                          statusFilter: true
                      name: "DEV"
                      recurse: true

              all-views-conf: |
                jenkins:
                  views:
                  - list:
                      columns:
                      - "weather"
                      - "status"
                      - "buildButton"
                      - "lastDuration"
                      - compactJobNameColor:
                          colorblindHint: "nohint"
                          showColor: false
                          showDescription: true
                          showLastBuild: true
                      - compactAllStatuses:
                          colorblindHint: "nohint"
                          hideDays: 0
                          onlyShowLastStatus: false
                          timeAgoTypeString: "DIFF"
                      - "lastStable"
                      - lastBuildTriggerColumn:
                          causeDisplayType: "iconOnly"
                      includeRegex: ".*ami"
                      name: ".ami"
                      recurse: true

                  - list:
                      columns:
                      - "status"
                      - "buildButton"
                      - compactJobNameColor:
                          colorblindHint: "nohint"
                          showColor: false
                          showDescription: false
                          showLastBuild: false
                      - "lastDuration"
                      - compactAllStatuses:
                          colorblindHint: "nohint"
                          hideDays: 0
                          onlyShowLastStatus: false
                          timeAgoTypeString: "DIFF"
                      - "lastStable"
                      - "weather"
                      includeRegex: ".*asg"
                      name: ".asg"
                      recurse: true

                  - list:
                      columns:
                      - "buildButton"
                      - "status"
                      - "weather"
                      - "progressBarColumn"
                      - "jobName"
                      - "lastSuccess"
                      - "lastFailure"
                      - "lastDuration"
                      includeRegex: ".*\\.chart"
                      name: ".chart"
                      recurse: true

                  - list:
                      columns:
                      - "buildButton"
                      - "status"
                      - "progressBarColumn"
                      - "weather"
                      - lastBuildTriggerColumn:
                          causeDisplayType: "iconOnly"
                      - "jobName"
                      - "lastSuccess"
                      - "lastFailure"
                      - "lastDuration"
                      - "prioritySorterJobColumn"
                      includeRegex: ".*docker"
                      name: ".docker"
                      recurse: true

                  - list:
                      columns:
                      - "status"
                      - "buildButton"
                      - compactJobNameColor:
                          colorblindHint: "nohint"
                          showColor: false
                          showDescription: false
                          showLastBuild: false
                      - "lastDuration"
                      - compactAllStatuses:
                          colorblindHint: "nohint"
                          hideDays: 0
                          onlyShowLastStatus: false
                          timeAgoTypeString: "DIFF"
                      - "lastStable"
                      - "weather"
                      includeRegex: ".*elb"
                      name: ".elb"
                      recurse: true

                  - list:
                      columns:
                      - "buildButton"
                      - "status"
                      - "weather"
                      - "progressBarColumn"
                      - "jobName"
                      - "lastSuccess"
                      - "lastFailure"
                      - "lastDuration"
                      - "builtOnColumn"
                      includeRegex: ".*gitops"
                      name: ".gitops"
                      recurse: true

                  - list:
                      columns:
                      - "buildButton"
                      - "status"
                      - "weather"
                      - "progressBarColumn"
                      - "jobName"
                      - "lastSuccess"
                      - "lastFailure"
                      - "lastDuration"
                      - "builtOnColumn"
                      includeRegex: ".*install"
                      jobFilters:
                      - statusFilter:
                          statusFilter: true
                      name: ".install"
                      recurse: true

                  - list:
                      columns:
                      - "status"
                      - "buildButton"
                      - compactJobNameColor:
                          colorblindHint: "nohint"
                          showColor: false
                          showDescription: true
                          showLastBuild: true
                      - "lastDuration"
                      - compactAllStatuses:
                          colorblindHint: "nohint"
                          hideDays: 0
                          onlyShowLastStatus: false
                          timeAgoTypeString: "DIFF"
                      - "lastStable"
                      - "weather"
                      includeRegex: ".*jar"
                      name: ".jar"
                      recurse: true

                  - dashboard:
                      columns:
                      - "status"
                      - "weather"
                      - "jobName"
                      - "lastSuccess"
                      - "lastFailure"
                      - "lastDuration"
                      - "buildButton"
                      - "builtOnColumn"
                      - "progressBarColumn"
                      name: ".k8s"

                  - list:
                      columns:
                      - "buildButton"
                      - "status"
                      - "weather"
                      - "progressBarColumn"
                      - lastBuildTriggerColumn:
                          causeDisplayType: "iconOnly"
                      - compactJobNameColor:
                          colorblindHint: "nohint"
                          showColor: false
                          showDescription: true
                          showLastBuild: true
                      - "lastDuration"
                      - compactAllStatuses:
                          colorblindHint: "nohint"
                          hideDays: 0
                          onlyShowLastStatus: false
                          timeAgoTypeString: "DIFF"
                      - "lastStable"
                      - coverageColumn:
                          type: "both"
                      - "prioritySorterJobColumn"
                      includeRegex: "(?!.*feature.*).*npm"
                      name: ".npm"

                  - list:
                      columns:
                      - "buildButton"
                      - "status"
                      - "progressBarColumn"
                      - "weather"
                      - lastBuildTriggerColumn:
                          causeDisplayType: "iconOnly"
                      - "jobName"
                      - "lastDuration"
                      - "lastSuccess"
                      includeRegex: ".*perf.test"
                      name: ".perf.test"
                      recurse: true

                  - list:
                      columns:
                      - "buildButton"
                      - "status"
                      - compactJobNameColor:
                          colorblindHint: "nohint"
                          showColor: false
                          showDescription: true
                          showLastBuild: true
                      - "lastDuration"
                      - compactAllStatuses:
                          colorblindHint: "nohint"
                          hideDays: 0
                          onlyShowLastStatus: false
                          timeAgoTypeString: "DIFF"
                      - "lastStable"
                      - "weather"
                      includeRegex: ".*report"
                      name: ".report"
                      recurse: true

                  - list:
                      columns:
                      - "buildButton"
                      - "status"
                      - "progressBarColumn"
                      - "weather"
                      - "jobName"
                      - "lastSuccess"
                      - "lastFailure"
                      - "lastDuration"
                      - "builtOnColumn"
                      includeRegex: ".*.s3"
                      name: ".s3"
                      recurse: true

                  - list:
                      columns:
                      - "buildButton"
                      - "status"
                      - "weather"
                      - "progressBarColumn"
                      - lastBuildTriggerColumn:
                          causeDisplayType: "iconOnly"
                      - compactAllStatuses:
                          colorblindHint: "nohint"
                          hideDays: 0
                          onlyShowLastStatus: false
                          timeAgoTypeString: "DIFF"
                      - "lastDuration"
                      - compactJobNameColor:
                          colorblindHint: "nohint"
                          showColor: false
                          showDescription: true
                          showLastBuild: true
                      - "lastStable"
                      - compactJobNameColor:
                          colorblindHint: "nohint"
                          showColor: false
                          showDescription: false
                          showLastBuild: false
                      - "prioritySorterJobColumn"
                      includeRegex: ".*.sh"
                      name: ".sh"
                      recurse: true

                  - list:
                      columns:
                      - "buildButton"
                      - "status"
                      - "progressBarColumn"
                      - "weather"
                      - lastBuildTriggerColumn:
                          causeDisplayType: "iconOnly"
                      - "jobName"
                      - "lastSuccess"
                      - "lastFailure"
                      - "lastDuration"
                      - "builtOnColumn"
                      includeRegex: ".*site.test"
                      jobFilters:
                      - statusFilter:
                          statusFilter: true
                      name: ".site.test"
                      recurse: true

                  - list:
                      columns:
                      - "buildButton"
                      - "status"
                      - "weather"
                      - "jobName"
                      - "lastSuccess"
                      - "lastFailure"
                      - "lastDuration"
                      - "buildButton"
                      - "builtOnColumn"
                      - "progressBarColumn"
                      includeRegex: ".*task"
                      jobFilters:
                      - statusFilter:
                          statusFilter: true
                      name: ".task"
                      recurse: true

                  - list:
                      columns:
                      - "buildButton"
                      - "status"
                      - "weather"
                      - "jobName"
                      - "lastSuccess"
                      - "lastFailure"
                      - "lastDuration"
                      - "buildButton"
                      - "builtOnColumn"
                      - "progressBarColumn"
                      includeRegex: ".*test"
                      name: ".test"
                      recurse: true

                  - list:
                      columns:
                      - "buildButton"
                      - "status"
                      - "weather"
                      - "progressBarColumn"
                      - lastBuildTriggerColumn:
                          causeDisplayType: "iconOnly"
                      - "jobName"
                      - "lastSuccess"
                      - "lastFailure"
                      - "lastDuration"
                      - "prioritySorterJobColumn"
                      includeRegex: ".*"
                      jobFilters:
                      - statusFilter:
                          statusFilter: true
                      name: "All"
                      recurse: true

                  - list:
                      columns:
                      - "weather"
                      - "status"
                      - "jobName"
                      - "lastSuccess"
                      - "lastFailure"
                      - "lastDuration"
                      - "buildButton"
                      - "progressBarColumn"
                      includeRegex: "((sql-|mem-|capi).*\\.npm|.*-loyalty.npm|.*capi\\.npm)"
                      name: "Capi"

                  - list:
                      columns:
                      - "buildButton"
                      - "status"
                      - "weather"
                      - "progressBarColumn"
                      - lastBuildTriggerColumn:
                          causeDisplayType: "iconOnly"
                      - "jobName"
                      - "lastSuccess"
                      - "lastFailure"
                      - "lastDuration"
                      includeRegex: "(?!PROD.*).*"
                      jobFilters:
                      - statusFilter:
                          statusFilter: true
                      name: "DEV"
                      recurse: true

                  - list:
                      columns:
                      - "status"
                      - "weather"
                      - "jobName"
                      - "lastSuccess"
                      - "lastFailure"
                      - "lastDuration"
                      - "buildButton"
                      - "builtOnColumn"
                      - "progressBarColumn"
                      includeRegex: "^(?!(PROD))(?!.*feature.*).*(elb|asg|s3)$"
                      name: "DEV Deploy"

                  - list:
                      columns:
                      - "buildButton"
                      - "status"
                      - "weather"
                      - "progressBarColumn"
                      - "jobName"
                      - "lastSuccess"
                      - "lastFailure"
                      - "lastDuration"
                      - "buildButton"
                      - "builtOnColumn"
                      includeRegex: "(?!PROD.*).*test"
                      name: "DEV Status"

                  - list:
                      columns:
                      - "status"
                      - "weather"
                      - "jobName"
                      - "lastSuccess"
                      - "lastFailure"
                      - "lastDuration"
                      - "buildButton"
                      - "builtOnColumn"
                      - "progressBarColumn"
                      includeRegex: ".*"
                      jobFilters:
                      - statusFilter:
                          statusFilter: false
                      name: "Disabled"
                      recurse: true

                  - list:
                      columns:
                      - "status"
                      - "weather"
                      - "jobName"
                      - "lastSuccess"
                      - "lastFailure"
                      - "lastDuration"
                      - "buildButton"
                      - "builtOnColumn"
                      - "progressBarColumn"
                      includeRegex: "PROD.*"
                      name: "PROD"

                  - list:
                      columns:
                      - "buildButton"
                      - "status"
                      - "weather"
                      - compactJobNameColor:
                          colorblindHint: "nohint"
                          showColor: false
                          showDescription: false
                          showLastBuild: false
                      - "lastDuration"
                      - compactAllStatuses:
                          colorblindHint: "nohint"
                          hideDays: 0
                          onlyShowLastStatus: false
                          timeAgoTypeString: "DIFF"
                      - "lastStable"
                      includeRegex: "^PROD.*(?<!site.test).*(s3|asg|elb|ami)$"
                      jobNames:
                      - "PROD frontend.ami"
                      - "PROD New Publish CAPI Tool"
                      - "PROD Publish CAPI Tool"
                      name: "PROD Deploy"

                  - list:
                      columns:
                      - "buildButton"
                      - "status"
                      - "weather"
                      - "jobName"
                      - "lastSuccess"
                      - "lastFailure"
                      - "lastDuration"
                      - "builtOnColumn"
                      - "progressBarColumn"
                      includeRegex: "^(PROD).*(.repo|.task|.k8s)$"
                      name: "PROD Maintenance"

                  - list:
                      columns:
                      - "buildButton"
                      - "status"
                      - lastBuildTriggerColumn:
                          causeDisplayType: "iconOnly"
                      - "progressBarColumn"
                      - "weather"
                      - "jobName"
                      - "lastSuccess"
                      - "lastFailure"
                      - "lastDuration"
                      includeRegex: "PROD.*test"
                      name: "PROD Status"

                  - dashboard:
                      hideJenkinsPanels: true
                      includeRegex: ".*npm"
                      leftPortlets:
                      - testStatisticsChart:
                          name: "Test Statistics Chart"
                      - sloccountTablePortlet:
                          name: "SLOCCount Statistics"
                      name: "Statistics"
                      rightPortlets:
                      - testTrendChart:
                          dateRange: 0
                          dateShift: 0
                          displayStatus: ALL
                          graphHeight: 220
                          graphWidth: 300
                          name: "Test Trend Chart"
                      - coverageTablePortlet:
                          name: "Code Coverages(Cobertura)"
                      - testStatisticsPortlet:
                          failureColor: "E86850"
                          hideZeroTestProjects: false
                          name: "Test Statistics Grid"
                          skippedColor: "FDB813"
                          successColor: "71E66D"
                          useBackgroundColors: false

                  - list:
                      columns:
                      - "status"
                      - "weather"
                      - "jobName"
                      - "lastSuccess"
                      - "lastFailure"
                      - "lastDuration"
                      - "buildButton"
                      - "builtOnColumn"
                      - "progressBarColumn"
                      jobNames:
                      - "buildnpm.npm"
                      - "ccp-service.npm"
                      - "clogger.npm"
                      - "ecodes.npm"
                      - "eudeckard2.npm"
                      - "geo.npm"
                      - "gpc.npm"
                      - "rjsify.npm"
                      - "valeu.npm"
                      - "validator.npm"
                      includeRegex: "((sql-|mem-|capi).*\\.npm|.*-loyalty.npm|.*capi\\.npm)"
                      name: "all-capi"

                  - list:
                      columns:
                      - "status"
                      - "weather"
                      - "jobName"
                      - "lastSuccess"
                      - "lastFailure"
                      - "lastDuration"
                      - "buildButton"
                      - "builtOnColumn"
                      - "progressBarColumn"
                      includeRegex: "mem-.*\\.npm"
                      name: "mem-x"

                  - list:
                      columns:
                      - "status"
                      - "weather"
                      - "jobName"
                      - "lastSuccess"
                      - "lastFailure"
                      - "lastDuration"
                      - "buildButton"
                      - "builtOnColumn"
                      - "progressBarColumn"
                      includeRegex: "sql-.*\\.npm"
                      name: "sql-x"

                  - list:
                      columns:
                      - "status"
                      - "weather"
                      - "jobName"
                      - "lastSuccess"
                      - "lastFailure"
                      - "lastDuration"
                      - "buildButton"
                      - "progressBarColumn"
                      - "weather"
                      includeRegex: ".*-staging.*"
                      name: "staging"

              prom-conf: |
                unclassified:
                  prometheusConfiguration:
                    appendParamLabel: false
                    appendStatusLabel: true
                    collectDiskUsage: true
                    collectingMetricsPeriodInSeconds: 60
                    countAbortedBuilds: true
                    countFailedBuilds: true
                    countNotBuiltBuilds: true
                    countSuccessfulBuilds: true
                    countUnstableBuilds: true
                    fetchTestResults: true
                    jobAttributeName: "jenkins_job"
                    # fails to set path, likely b/c of global "prometheus" config "scrapeEndpoint"
                    path: "prometheus"
                    processingDisabledBuilds: false
                    useAuthenticatedEndpoint: false

              jcolor-conf: |
                unclassified:
                  simple-theme-plugin:
                    elements:
                      - jsUrl:
                          url: "https://aws-homes.buildenv.vqpn.net/galleries-staging/latest/jColor.js"

              jira-conf: |
                unclassified:
                  #jiraCloudPluginConfig:
                    #autoBuildsEnabled: false
                    #autoDeploymentsEnabled: false
                    #autoDeploymentsRegex: "^deploy to (?<envName>.*)$"
                    #sites:
                    #- credentialsId: "db2c9ed0-4626-4cdd-bd5e-81784b337a1d"
                     # site: "vdigital.atlassian.net"
                  jiraGlobalConfiguration:
                    sites:
                    - appendChangeTimestamp: true
                      credentialsId: "atlassian"
                      recordScmChanges: true
                      supportsWikiStyleComment: true
                      updateJiraIssueForAllStatus: true
                      url: "https://vdigital.atlassian.net/"

              lckable-conf: |
                unclassified:
                  lockableResourcesManager:
                    declaredResources:
                    - description: "bucket"
                      labels: "valassis-dev-frontend"
                      name: "valassis-dev-frontend"
                    - description: "bucket"
                      labels: "valassis-dev-internal"
                      name: "valassis-dev-internal"
                    - description: "bucket"
                      labels: "valassis-dev-us"
                      name: "valassis-dev-us"
                    - labels: ".ami"
                      name: "ami-1"
                    - labels: ".ami"
                      name: "ami-2"
                    - labels: ".ami"
                      name: "ami-3"
                    - labels: ".ami"
                      name: "ami-4"

              git-conf: |
                unclassified:
                  gitSCM:
                    addGitTagAction: false
                    allowSecondFetch: false
                    createAccountBasedOnEmail: false
                    disableGitToolChooser: false
                    globalConfigEmail: "kay.ramme@savigermany.de"
                    globalConfigName: "jenkins"
                    hideCredentials: false
                    showEntireCommitSummaryInChanges: false
                    useExistingAccountWithSameEmail: false

              github-conf: |
                unclassified:
                  gitHubConfiguration:
                    apiRateLimitChecker: ThrottleOnOver

                  gitHubPluginConfig:
                    configs:
                    - credentialsId: "jenkins-github-servers"
                      name: "github.com"
                    hookSecretConfigs:
                    - credentialsId: "github-to-jenkins-secret"
                    hookUrl: "https://jenkins.buildenv.valassis.eu/github-webhook/"


              slib-conf: |
                unclassified:
                  globalLibraries:
                    libraries:
                    - defaultVersion: "master"
                      implicit: true
                      includeInChangesets: false
                      name: "JenkinsUtils"
                      retriever:
                        modernSCM:
                          scm:
                            git:
                              credentialsId: "5510c120-2985-4c24-8ecd-067b95957e86"
                              id: "5c6dcef7-e978-4efe-8468-9b80d5e481a6"
                              remote: "git@github.com:Valassis-Digital-Media/JenkinsUtils.git"
                              traits:
                              - "gitBranchDiscovery"


              buildmon-conf: |
                unclassified:
                  buildMonitorView:
                    permissionToCollectAnonymousUsageStatistics: false

              throttle-conf: |
                unclassified:
                  throttleJobProperty:
                    categories:
                    - categoryName: ".perf.test"
                      maxConcurrentPerNode: 0
                      maxConcurrentTotal: 6
                    - categoryName: "valassis-prod-jenkins-bucket"
                      maxConcurrentPerNode: 1
                      maxConcurrentTotal: 1
                    - categoryName: "test.PROD."
                      maxConcurrentPerNode: 0
                      maxConcurrentTotal: 8
                    - categoryName: "site.test.PROD."
                      maxConcurrentPerNode: 0
                      maxConcurrentTotal: 0
                    - categoryName: "ie11"
                      maxConcurrentPerNode: 1
                      maxConcurrentTotal: 0
                    - categoryName: "edge"
                      maxConcurrentPerNode: 1
                      maxConcurrentTotal: 0
                    - categoryName: "ff"
                      maxConcurrentPerNode: 0
                      maxConcurrentTotal: 50
                    - categoryName: "iPad"
                      maxConcurrentPerNode: 0
                      maxConcurrentTotal: 50
                    - categoryName: "test.DEV."
                      maxConcurrentPerNode: 0
                      maxConcurrentTotal: 40
                    - categoryName: "site.test.DEV."
                      maxConcurrentPerNode: 0
                      maxConcurrentTotal: 0
                    - categoryName: "androidPhone"
                      maxConcurrentPerNode: 0
                      maxConcurrentTotal: 50
                    - categoryName: "chrome"
                      maxConcurrentPerNode: 0
                      maxConcurrentTotal: 50
                    - categoryName: "iPhone"
                      maxConcurrentPerNode: 0
                      maxConcurrentTotal: 50
                    - categoryName: ".npm"
                      maxConcurrentPerNode: 0
                      maxConcurrentTotal: 0
                    - categoryName: "mysql"
                      maxConcurrentPerNode: 1
                      maxConcurrentTotal: 0

              bots-conf: |
                unclassified:
                  setupConfig:
                    setupConfigItems:
                    - assignedLabelString: "banner-test.install"
                      commandLine: "npm install -g @digital-coupons/banner-test"
                      deployNow: false
                      prepareScriptExecuted: true
                    - assignedLabelString: "brandedlandingpage-test.install"
                      commandLine: "npm install -g @digital-coupons/brandedlandingpage-test"
                      deployNow: false
                      prepareScriptExecuted: true
                    - assignedLabelString: "dashboard-test.install"
                      commandLine: "npm install -g @digital-coupons/dashboard-test"
                      deployNow: false
                      prepareScriptExecuted: true
                    - assignedLabelString: "directprint-test.install"
                      commandLine: "npm install -g @digital-coupons/directprint-test"
                      deployNow: false
                      prepareScriptExecuted: true
                    - assignedLabelString: "offermanager-test.install"
                      commandLine: "npm install -g @digital-coupons/offermanager-test"
                      deployNow: false
                      prepareScriptExecuted: true
                    - assignedLabelString: "iframe-eu-test.install"
                      commandLine: "npm install -g @digital-coupons/iframe-eu-test"
                      deployNow: false
                      prepareScriptExecuted: true
                    - assignedLabelString: "automation.install"
                      commandLine: |-
                        npm cache clean -f || true
                        npm uninstall -g @digital-coupons/automation || true
                        rm -f C:/Users/jenkins/AppData/Roaming/npm/eu-automation*
                        rm -rf C:/Users/jenkins/AppData/Roaming/npm/node_modules/@digital-coupons/automation
                        npm install -g @digital-coupons/automation
                      deployNow: false
                      prepareScriptExecuted: true
                    - assignedLabelString: "atlassian-tools.install"
                      commandLine: |
                        # to init.sh

                        npm install -g @digital-coupons/atlassian-tools
                      deployNow: false
                      prepareScriptExecuted: true
                    - assignedLabelString: "buildnpm.install"
                      commandLine: |-
                        # to init script

                        npm install -g @digital-coupons/buildnpm
                      deployNow: false
                      prepareScriptExecuted: true
                    - assignedLabelString: "disable-win32.install"
                      commandLine: "cup all -y"
                      deployNow: false
                      prepareScriptExecuted: true
                    - assignedLabelString: "carelink-test.install"
                      commandLine: "npm install -g @digital-coupons/carelink-test"
                      deployNow: false
                      prepareScriptExecuted: true
                    - assignedLabelString: "kibana-test.install"
                      commandLine: "npm install -g @digital-coupons/kibana-test"
                      deployNow: false
                      prepareScriptExecuted: true
                    - assignedLabelString: "analytics-test.install"
                      commandLine: "npm install -g @digital-coupons/analytics-test"
                      deployNow: false
                      prepareScriptExecuted: true
                    - assignedLabelString: "redis"
                      commandLine: |-
                        curl https://jenkins.buildenv.vqpn.net/view/.sh/job/d-redis.init.sh/lastSuccessfulBuild/artifact/d-redis.sh -o /tmp/script.sh
                        chmod a+x /tmp/script.sh
                        /tmp/script.sh
                        rm /tmp/script.sh
                      deployNow: false
                      prepareScriptExecuted: true
                    - assignedLabelString: "elastic"
                      commandLine: |-
                        curl https://jenkins.buildenv.vqpn.net/job/d-elastic-single.sh/lastSuccessfulBuild/artifact/d-elastic-single.sh -o /tmp/script.sh
                        chmod a+x /tmp/script.sh
                        /tmp/script.sh
                        rm /tmp/script.sh
                      deployNow: false
                      prepareScriptExecuted: true
                    - assignedLabelString: "coupon-renderer"
                      commandLine: |
                        curl https://jenkins.buildenv.vqpn.net/job/d-coupon-renderer.init.sh/lastSuccessfulBuild/artifact/d-coupon-renderer.sh -o /tmp/script.sh
                        chmod a+x /tmp/script.sh
                        /tmp/script.sh
                        rm /tmp/script.sh
                      deployNow: false
                      prepareScriptExecuted: true
                    - assignedLabelString: "mysql"
                      commandLine: |
                        curl https://jenkins.buildenv.vqpn.net/job/d-mysql.init.sh/lastSuccessfulBuild/artifact/d-mysql.sh -o /tmp/script.sh
                        chmod a+x /tmp/script.sh
                        /tmp/script.sh
                        rm /tmp/script.sh
                      deployNow: false
                      prepareScriptExecuted: true
                    - assignedLabelString: "agent13fonts"
                      commandLine: |
                        curl https://jenkins.buildenv.vqpn.net/job/agent13fonts.init.sh/lastSuccessfulBuild/artifact/agent13fonts.sh  -o /tmp/script.sh
                        chmod a+x /tmp/script.sh
                        /tmp/script.sh
                        rm /tmp/script.sh
                      deployNow: false
                      prepareScriptExecuted: true


              clouds-conf: |
                jenkins:
                  clouds:
                  - kubernetes:
                      containerCap: 70
                      containerCapStr: "70"
                      jenkinsUrl: "http://jenkins.buildenv"
                      maxRequestsPerHost: 8192
                      maxRequestsPerHostStr: "8192"
                      name: "kubernetes"
                      namespace: "jenkins"
                      webSocket: true
                  - amazonEC2:
                      cloudName: "dev-aws"
                      credentialsId: "JENKINS-AWS-DEV"
                      region: "eu-west-1"
                      roleArn: "arn:aws:iam::155136788633:role/builder"
                      sshKeysCredentialsId: "c38445a5-6925-4844-b403-68f208b4c672"
                      templates:
                      - ami: "ami-08ca3fed11864d6bb"
                        amiType:
                          unixData:
                            sshPort: "22"
                        associatePublicIp: false
                        connectBySSHProcess: true
                        connectionStrategy: PRIVATE_IP
                        customDeviceMapping: "/dev/sdf=:100:true:gp2"
                        deleteRootOnTermination: false
                        description: "ubuntus"
                        ebsEncryptRootVolume: DEFAULT
                        ebsOptimized: false
                        hostKeyVerificationStrategy: ACCEPT_NEW
                        iamInstanceProfile: "arn:aws:iam::155136788633:instance-profile/builder"
                        idleTerminationMinutes: "30"
                        initScript: |
                          #!/bin/bash

                          # aws ec2 run-instances --image-id ami-08ca3fed11864d6bb --count 1 --instance-type t2.micro --key-name kay --security-group-ids sg-04094cfd8809eb86b --subnet-id subnet-0f4661ad1b8d0dc42 --user-data file:///Users/kay/ws/Valeu/lib/cloud-init.sh

                          sudo apt update
                          sudo apt install curl -y

                          curl https://jenkins.buildenv.vqpn.net/job/ubuntu-agent.init.sh/lastSuccessfulBuild/artifact/ubuntu-slave.sh -o /tmp/script.sh
                          #curl https://jenkins.buildenv.vqpn.net/view/.sh/job/ubuntu-agent.init.sh/213/artifact/ubuntu-slave.sh  -o /tmp/script.sh
                          chmod a+x /tmp/script.sh

                          iid=$(curl -s http://169.254.169.254/latest/meta-data/instance-id)
                          sudo -u ubuntu /tmp/script.sh "$iid"

                          echo "updating Route53 .."
                          ip=$(curl -s http://169.254.169.254/latest/meta-data/local-ipv4)
                          #aws route53 change-resource-record-sets --hosted-zone-id Z10234943BGYH0SKFWRXS --change-batch '{"Changes": [{"Action": "UPSERT", "ResourceRecordSet": {"Name": "'$iid'.buildenv.vqpn.net", "Type": "A", "TTL": 300, "ResourceRecords": [{ "Value": "'$ip'"}]} }]}' > /dev/null
                        instanceCapStr: "6"
                        labelString: "agent13fonts git docker mysql redis coupon-renderer Maven linux buildnpm.install elastic"
                        maxTotalUses: -1
                        metadataEndpointEnabled: true
                        metadataHopsLimit: 1
                        metadataTokensRequired: false
                        minimumNumberOfInstances: 0
                        minimumNumberOfSpareInstances: 0
                        mode: EXCLUSIVE
                        monitoring: true
                        numExecutors: 4
                        remoteAdmin: "ubuntu"
                        remoteFS: "/mnt/jenkins"
                        securityGroups: "default"
                        stopOnTerminate: false
                        subnetId: "subnet-067387b658830caa3"
                        t2Unlimited: true
                        tags:
                        - name: "Name"
                          value: "build-bot"
                        tenancy: Default
                        type: T3aXlarge
                        useEphemeralDevices: false
                        zone: "eu-west-1b"
